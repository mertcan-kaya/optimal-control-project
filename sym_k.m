clc, clear all, close all

syms t T k1 k2 q1 q2 p

x(t) = (exp(-t*(k2/2 + (k2^2 - 4*k1 - 4)^(1/2)/2))*((k2^2 - 4*k1 - 4)^(1/2) - k2 + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)) + (exp(-t*(k2/2 - (k2^2 - 4*k1 - 4)^(1/2)/2))*(k2 + (k2^2 - 4*k1 - 4)^(1/2) - 2))/(2*(k2^2 - 4*k1 - 4)^(1/2))

Dx(t) = (exp(-t*(k2/2 + (k2^2 - 4*k1 - 4)^(1/2)/2))*(2*k1 - k2 - (k2^2 - 4*k1 - 4)^(1/2) + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)) - (exp(-(t*(k2 - (k2^2 - 4*k1 - 4)^(1/2)))/2)*(2*k1 - k2 + (k2^2 - 4*k1 - 4)^(1/2) + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2))

u(t) = - k2*((exp(-t*(k2/2 + (k2^2 - 4*k1 - 4)^(1/2)/2))*(2*k1 - k2 - (k2^2 - 4*k1 - 4)^(1/2) + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)) - (exp(-(t*(k2 - (k2^2 - 4*k1 - 4)^(1/2)))/2)*(2*k1 - k2 + (k2^2 - 4*k1 - 4)^(1/2) + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2))) - k1*((exp(-t*(k2/2 + (k2^2 - 4*k1 - 4)^(1/2)/2))*((k2^2 - 4*k1 - 4)^(1/2) - k2 + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)) + (exp(-(t*(k2 - (k2^2 - 4*k1 - 4)^(1/2)))/2)*(k2 + (k2^2 - 4*k1 - 4)^(1/2) - 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)))

% figure
% fplot(subs(x,[k1 k2],[0.4142 1.3522]),[0 10])
% hold on
% fplot(subs(x,[k1 k2],[103.28363314035452 10.472826448150933]),[0 10])

% isefunc(t) = int(x^2,t,[0 T])
% 
% % isefunc(t) = -(exp(-(3044868957546831*t)/2251799813685248)*(363968429312410339735199159429506059151581248483078882633745979709048085282816*sin((t*(20282409603651670423947251286016*2^(1/2) - 9271226968632325322549558142561)^(1/2))/2251799813685248) - 72441990766895059372029172418692895360635990603000269858930688*(20282409603651670423947251286016*2^(1/2) - 9271226968632325322549558142561)^(1/2) - 644048514624360480714964585143892149469031576659046361055576707654215339521167*2^(1/2)*sin((t*(20282409603651670423947251286016*2^(1/2) - 9271226968632325322549558142561)^(1/2))/2251799813685248) - 199856851110012043146016180562701066994388958927683387608174399*exp((3044868957546831*t)/2251799813685248)*(40564819207303340847894502572032*2^(1/2) - 18542453937264650645099116285122)^(1/2) - 5831218555138712123354967256967746128453024276514095310401729*cos((t*(20282409603651670423947251286016*2^(1/2) - 9271226968632325322549558142561)^(1/2))/2251799813685248)*(40564819207303340847894502572032*2^(1/2) - 18542453937264650645099116285122)^(1/2) + 68507816839606915052240921620821489552670406218593315365847040*exp((3044868957546831*t)/2251799813685248)*(20282409603651670423947251286016*2^(1/2) - 9271226968632325322549558142561)^(1/2) + 205688069665150755269371147819668813122841983204197482918576128*(40564819207303340847894502572032*2^(1/2) - 18542453937264650645099116285122)^(1/2) + 3934173927288144319788250797871405807965584384406954493083648*cos((t*(20282409603651670423947251286016*2^(1/2) - 9271226968632325322549558142561)^(1/2))/2251799813685248)*(20282409603651670423947251286016*2^(1/2) - 9271226968632325322549558142561)^(1/2)))/(27425741405199797391854615396352*(20282409603651670423947251286016*2^(1/2) - 9271226968632325322549558142561)^(3/2))
%  
% simplify(isefunc)
% 
% simplify(isefunc,'Steps',500)

% ISE(T) = - (((exp(-T*(k2^2 - 4*k1 - 4)^(1/2))*exp(-T*k2))/2 - 1/2)*(k2 + (- 2*k2^2 + 4*k2 + 2*k1)/(k2 + (k2^2 - 4*k1 - 4)^(1/2)) - 2))/(- k2^2 + 4*k1 + 4) - (2*(exp(-T*(k2 - (k2^2 - 4*k1 - 4)^(1/2)))/2 - 1/2)*(k2 + (- 2*k2^2 + 4*k2 + 2*k1)/(k2 - (k2^2 - 4*k1 - 4)^(1/2)) - 2))/(- 2*k2^2 + 8*k1 + 8) - (8*(exp(-T*k2)/2 - 1/2)*(k1 - k2 + 2))/(k2*(- 2*k2^2 + 8*k1 + 8))
% 
% % ise_num(T) = subs(ISE,[k1 k2],[0.4142 1.3522])
% 
% ise_num(T) = subs(ISE,[k1 k2],[103.28363314035452 10.472826448150933])
% 
% figure
% fplot(ise_num(T),[0 10])
% 
% Tnum = 0:0.1:10;
% 
% figure
% plot(Tnum,ise_num(Tnum))
% 
% PI = int(q1*x*x+q2*Dx*Dx+p*u*u,t,[0 T])
% 
% simplify(PI)
% 
% itsefunc(t) = int(t*x^2,t,[0 T])
% simplify(itsefunc)
% simplify(itsefunc,'Steps',500)
% 
% iseufunc(t) = int(x^2+u^2,t,[0 T])
% simplify(iseufunc)
% simplify(iseufunc,'Steps',500)

% q1xxpuu = int(q1*x^2+p*u^2,t,[0 T])
% simplify(q1xxpuu)
% simplify(q1xxpuu,'Steps',500)

% xnum = subs(x,[k1 k2],[0.4142 1.3522])
% 
% isefuncinf = int(xnum^2,t,0,inf)
% isefunc10 = int(xnum^2,t,0,10)
% 
% vpa(isefuncinf)
% vpa(isefunc10)

% simplify(isefunc)
% simplify(isefunc,'Steps',500)
% 
% isefunc(t) =
%  
% (k2 + (2*k1 + 2*k2 - k2*(k2 - 2) - k2^2)/(k2 + (k2^2 - 4*k1 - 4)^(1/2)) - 2)/(- 2*k2^2 + 8*k1 + 8) + limit(- (exp(-t*k2)*((4*k1 + 8)/k2 - 4))/(- 2*k2^2 + 8*k1 + 8) - (exp(- t*(k2^2 - 4*k1 - 4)^(1/2) - t*k2)*(k2 + (2*k1 + 2*k2 - k2*(k2 - 2) - k2^2)/(k2 + (k2^2 - 4*k1 - 4)^(1/2)) - 2))/(- 2*k2^2 + 8*k1 + 8) - (exp(t*(k2^2 - 4*k1 - 4)^(1/2) - t*k2)*(k2 + (2*k1 + 2*k2 - k2*(k2 - 2) - k2^2)/(k2 - (k2^2 - 4*k1 - 4)^(1/2)) - 2))/(- 2*k2^2 + 8*k1 + 8), t, Inf) + ((4*k1 + 8)/k2 - 4)/(- 2*k2^2 + 8*k1 + 8) + (k2 + (2*k1 + 2*k2 - k2*(k2 - 2) - k2^2)/(k2 - (k2^2 - 4*k1 - 4)^(1/2)) - 2)/(- 2*k2^2 + 8*k1 + 8)
%  

% itsefuncinf = int(t*x^2,t,0,inf)
% 
% subs(itsefuncinf,[k1 k2],[0.4142 1.3522])

% iseufuncinf = int(x^2+u^2,t,0,inf)

q1 = 6.0989;
q2 = 14.7254;
p = 5.5300;

qliinf = int(q1*x*x+q2*Dx*Dx+p*u*u,t,0,inf)