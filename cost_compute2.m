clc, clear all, close all

syms t

% % question 1
% q1 = 1;
% q2 = 1;
% p = 1;
% 
% k1 = 0.4142;
% k2 = 1.3522;

% % case 1
% q1 = 6.0989;
% q2 = 14.7254;
% p = 5.5300;
% 
% k1 = 0.4501;
% k2 = 1.8876;

% % case 2
% q1 = 10.3195;
% q2 = 19.2388;
% p = 7.0311;
% 
% k1 = 0.5709;
% k2 = 1.9693;

% % case 3
% q1 = 38.4709;
% q2 = 7.8944;
% p = 0.7424;
% 
% k1 = 6.2678;
% k2 = 4.8135;
    
% % case 4a
% q1 = 29.5069;
% q2 = 0.0001;
% p = 7.3176e-05;
% 
% k1 = 634.0051;
% k2 = 35.6222;

% % case 4b
% q1 = 37.0496;
% q2 = 0.0001;
% p = 3.5154e-05;
% 
% k1 = 1.0e+03 * 1.0256;
% k2 = 1.0e+03 * 0.0453;

% % case 5a
% q1 = 18.0236;
% q2 = 0.0015;
% p = 18.0686;
% 
% k1 = 0.4133;
% k2 = 0.9093;

% % case 5b
% q1 = 18.9322;
% q2 = 0.0005;
% p = 18.9332;
% 
% k1 = 0.4142;
% k2 = 0.9102;

% % case 6a
% q1 = 34.0198;
% q2 = 0.0001;
% p = 1.0414e-04;
% 
% k1 = 570.5663;
% k2 = 33.7879;
   
% % case 6b
% q1 = 31.7299;
% q2 = 0.0001;
% p = 4.2596e-05;
% 
% k1 = 862.0835;
% k2 = 41.5455;
 
% % case 7a  
% q1 = 1.0e-04 * 0.4870;
% q2 = 1.0e-04 * 0.1300;
% p = 5.6910e-05;
% 
% k1 = 0.3623;
% k2 = 0.9762;

% case 7b
q1 = 1.0e-04 * 0.9922;
q2 = 1.0e-04 * 0.1000;
p = 1.0000e-05;

k1 = 2.3048;
k2 = 2.3685;
    
x(t) = (exp(-t*(k2/2 + (k2^2 - 4*k1 - 4)^(1/2)/2))*((k2^2 - 4*k1 - 4)^(1/2) - k2 + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)) + (exp(-t*(k2/2 - (k2^2 - 4*k1 - 4)^(1/2)/2))*(k2 + (k2^2 - 4*k1 - 4)^(1/2) - 2))/(2*(k2^2 - 4*k1 - 4)^(1/2));

Dx(t) = (exp(-t*(k2/2 + (k2^2 - 4*k1 - 4)^(1/2)/2))*(2*k1 - k2 - (k2^2 - 4*k1 - 4)^(1/2) + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)) - (exp(-(t*(k2 - (k2^2 - 4*k1 - 4)^(1/2)))/2)*(2*k1 - k2 + (k2^2 - 4*k1 - 4)^(1/2) + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2));

u(t) = - k2*((exp(-t*(k2/2 + (k2^2 - 4*k1 - 4)^(1/2)/2))*(2*k1 - k2 - (k2^2 - 4*k1 - 4)^(1/2) + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)) - (exp(-(t*(k2 - (k2^2 - 4*k1 - 4)^(1/2)))/2)*(2*k1 - k2 + (k2^2 - 4*k1 - 4)^(1/2) + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2))) - k1*((exp(-t*(k2/2 + (k2^2 - 4*k1 - 4)^(1/2)/2))*((k2^2 - 4*k1 - 4)^(1/2) - k2 + 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)) + (exp(-(t*(k2 - (k2^2 - 4*k1 - 4)^(1/2)))/2)*(k2 + (k2^2 - 4*k1 - 4)^(1/2) - 2))/(2*(k2^2 - 4*k1 - 4)^(1/2)));

omegan = sqrt((k1 + 1));
zeta = k2/(2*omegan);

omegad = omegan*sqrt(1-zeta^2);
phi = acos(zeta);

tshft = -acosh((omegan-zeta)/sqrt(1-2*zeta*omegan+omegan^2))/(sqrt(zeta^2-1)*omegan);

tr = tshft+real((pi-phi)/omegad);

tp = tshft+real(pi/omegad);
Mp = exp(-zeta*omegan*tp)*(cosh(sqrt(zeta^2-1)*omegan*tp)+sinh(sqrt(zeta^2-1)*omegan*tp)*(zeta*omegan-1)/(sqrt(zeta^2-1)*omegan));

y = abs(tr-1)+100*abs(Mp)